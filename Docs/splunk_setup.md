Splunk Enterprise Setup & Configuration
## üöÄ Project Overview
This document details the configuration of Splunk Enterprise to serve as the centralized logging and analysis platform for the cybersecurity lab. It focuses on data ingestion from Suricata and the creation of search queries to detect malicious activity.

## üõ†Ô∏è Environment Details
Splunk Instance: Splunk Enterprise 10.0.2

- **Host OS**: Ubuntu Server (Running in Oracle VirtualBox)

- **Configuration Path**: /opt/splunk/etc/system/local/inputs.conf

- **Target Index**: suricata

## 1. Data Input Configuration (inputs.conf)
To ingest Suricata logs, I configured the backend inputs.conf file to monitor the specific log outputs generated by the IDS. This ensures that both summarized alerts and detailed JSON telemetry are indexed.

- **File Path**: /opt/splunk/etc/system/local/inputs.conf

Ini, TOML
```
[monitor:///var/log/suricata/eve.json]
disabled = false
index = suricata
sourcetype = suricata:json

[monitor:///var/log/suricata/fast.log]
disabled = false
index = suricata
sourcetype = suricata:fast
eve.json: Provides deep packet metadata and alert details in JSON format.
```

- **fast.log**: Provides a simplified, high-level summary of alerts.

## 2. Search & Analysis Queries
Once the data is indexed, I used Splunk Search Processing Language (SPL) to filter and visualize attack data.

A. Detecting SSH Brute Force
The following query was used to identify high-frequency login attempts from a single source.

- **Query**:

- **Code snippet**
```
index=suricata sourcetype="suricata:json" alert.signature="SSH Brute Force Attempt Detected"
| table _time, src_ip, dest_ip, alert.category, alert.severity
```
- **Results Observed:

- **Events Captured**: 6 high-confidence alerts within a 24-hour window.

- **Attacker IP**: 192.168.10.250

- **Victim1 IP**: 192.168.10.10

- **Victim2 IP**: 192.168.10.100

- **Severity Level**: 3

## 3. Lab Verification
To verify that Splunk is correctly receiving data from the Ubuntu Server, I utilized the Data Inputs and Search views in the Splunk Web UI.

- **Verify Indexing**: Run index="suricata" to confirm events are appearing in the timeline.

- **Verify Source Types**: Ensure suricata:json and suricata:fast are correctly parsed so that fields like src_ip and alert.signature are searchable.

## üîç Key Implementation Notes
- **Real-time Monitoring**: By using the monitor:// stanza in inputs.conf, Splunk acts as a live listener, updating the dashboard as soon as Suricata writes to the log files.

- **Centralization**: This setup allows for the correlation of network-level IDS alerts with host-level logs (such as Sysmon or Windows Security logs) in a single pane of glass.
